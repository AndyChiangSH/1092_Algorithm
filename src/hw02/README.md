# HW02_three sum

[![hackmd-github-sync-badge](https://hackmd.io/ciP3-k6NSRiUaPT-SDEbTw/badge)](https://hackmd.io/ciP3-k6NSRiUaPT-SDEbTw)


###### tags: `演算法` `Java`

## 題目

給予一個長度為N的陣列，求出任意三個數字合為零的有幾組?

條件:
* 陣列數字不重複，且範圍不超過int值域。
* 數字相同但順序不同算同一個。

## 解題想法

### 暴力解
三層for迴圈，但這就是個垃圾。

### 耀中提供的解法
> HW_4108056005_1.java

兩層for迴圈，先算出兩個數字和，再用二元搜尋數找到第三個數字。看的出來時間複雜度為: $O(N^2log(N))$

#### 缺點
還是跑了許多不必要的迴圈，而且在搜尋是搜尋整個陣列，因此我想，既然我都已經知道第三個數字是正還是負了，那何不縮小搜尋範圍呢?

### 分正負
> HW_4108056005_2.java

我仔細想想，三個值加起來為零的組合不外乎這幾種:

* 正 + 負 + 正
* 正 + 負 + 負
* 正 + 負 + 零

我觀察一下發現了，無論是哪一種組合，第一個數字都為正，第二個數字都為負，第三個數字要看情況，如果前兩個數字和為正，那第三個數字為負，如果前兩個數字和為負，那第三個數字為正，最後如果前兩個數字和為零，那第三個數字為零(要看陣列中有沒有零)。

起初的想法是將正和負分開來存在不同的陣列，後來發現光是分堆就花了$O(2N)$的複雜度。

於是我換個想法，既然陣列都已經排序好了，何不紀錄**最小非負數的索引值**，小於索引值的都是負數，大於索引值的都是正數(考慮到有零的情況，正數開始的索引等於最小非負數的索引值+1)。

這樣做的確跑得比較快。時間複雜度為: $O(\dfrac{N^2}{4}log( \dfrac{N}{2}))$。

但不知道為甚麼，自己是都過，上系統就錯，後來也不想管這個方法了。

#### 缺點
還是多了一些不必要的搜尋，像是如果值已經比正值小了，或已經超過最大正數或最小負數，這些是不是可以直接忽略呢?

### 神奇夾擊法
> HW_4108056005_3.java

LeetCode提供的解法，作法是讓i從最右邊開始，設left為i+1，right為A.length-1。

試想，在固定i的情況下，會有三種情形:
* 三數合大於零，right必須左移，合會變小，才能讓合趨近零。
* 三數合小於零，left必須右移，合會變大，才能讓合趨近零。
* 三數和等於零，代表此為一個解，count++，且right和left往內移。

i的for迴圈複雜度為O(N)，right和left移動的worst case為O(N)，因此這樣的時間複雜度為O(N^2^)。

還能不能再更好呢?

想一下，當i到正數的時候會發生：  
因為陣列是排序過的，因此在i之後的數字一定是正數，而三個正數加起來不可能為零，所以可以直接不考慮。如果是正負數各1/2的時候，可以少跑一半的迴圈，時間複雜度降到O(N^2^/2)。

還有方法可以更快，設定i時，直接去找-(A\[i\]+A\[right\])的位置，可以讓i少跑前面的冤忘路。

### 最速傳說 - 多執行序
> HW_4108056005_4.java

傳承至學長 - kashiwa的多執行序法，透過執行序，將i的範圍切成8等分，然後分擔給各個執行序處理，最後join起來。

幾個多執行序注意點:  
* 紀錄總數的變數要加上 volatile static ，以避免同步問題
* 陣列大小不可小於執行序數量

這樣平均可以比沒多執行序快個2~3倍，陣列越大差距越多。
其中一次測驗還跑出了0.040秒的亮眼成績，奪得第一名的寶座，以下附圖留做紀念:

![](https://i.imgur.com/pUEbV18.png)

### Kashiwa is god
> HW_4108056005_5.java

[kashiwa](https://github.com/liao2000) 學長去年寫的版本，跑得很快沒錯，但終究被我送下去了XD  
我猜是因為我執行序是另外開一個class，而kashiwa用new，所以我的比較快一點(?

### 兩種sort比較
MergeSort 和 QuickSort 理論上都是O(NlogN)，但QuickSort的worst case 會是O(N^2^)，較不穩定，因此我選用 MergeSort。  
[參考網址](https://www.geeksforgeeks.org/quick-sort-vs-merge-sort/)

## 排名(2021-03-16 21:31:56)
| 版本號  | 排名 | 時間(秒) |
| ------ | ----- | ----- |
| 1      | 5     | 0.04945763129999999 |
| 2      | X     | Wrong Answer       |
| 3      | 21    | 0.11248280209999999    |
| 4      | 1     | 0.040674333599999994   |
| 5      | 10    | 0.052242523799999996   |